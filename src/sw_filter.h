#ifndef __SW_FILTER_H__#define __SW_FILTER_H__#include "sw_parse.h"#include "sw_command.h"//#define SW_FILTER_ACL_NAME "vswitch-acl-"//#define SW_FILTER_ACL_NUM  256 #define SW_FILTER_SHOW_RULE_LEN 128#define MAX_ACL_RULE_NUM	10000#define SW_FILTER_CFG "../conf/filter.conf"#define SW_FILTER_CFG_TMP "../conf/filter.conf.tmp"#define SW_FILTER_Log_Error(fmt,...) printf("\033[0;32;31m[SWFILT ERROR] \033[m"fmt, ##__VA_ARGS__)#define SW_FILTER_Log_Info(fmt,...) printf("\033[0;32;32m[SWFILT INFO] \033[m"fmt, ##__VA_ARGS__)
extern cmdline_parse_inst_t cmd_show_acl;struct cmd_show_acl_result {	cmdline_fixed_string_t show;	cmdline_fixed_string_t acl;	cmdline_fixed_string_t port;	uint16_t port_id;};extern cmdline_parse_inst_t cmd_add_acl;struct cmd_add_acl_result {	cmdline_fixed_string_t add;	cmdline_fixed_string_t acl;};extern cmdline_parse_inst_t cmd_del_acl;struct cmd_del_acl_result {	cmdline_fixed_string_t del;	cmdline_fixed_string_t acl;	uint16_t port_id;	uint16_t rule_id;};#ifdef __cplusplusextern "C" {#endifuint32_t sw_filter_http_show_rules(uint32_t portid, char** rule_arr, uint32_t* rule_num, char* buf, int buf_len);uint32_t sw_filter_dynamic_add_rules(char* rules, char* error, int err_len);uint32_t sw_filter_dynamic_del_rule(int port, int rule_id, char* error, int err_len);#ifdef __cplusplus}#endifint sw_filter_port(uint16_t port_id, uint16_t thread_id, PKT_INFO_S* pkt_info);int sw_filter_init(const char *);#endif